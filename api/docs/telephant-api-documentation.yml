openapi: 3.0.0

info:
  title: Telephant API
  description: |
    *The mechanism for swapping airtime is powered by Telephant's APIs. Developers can use the API to tap into the platform's capabilities and incorporate the service into their own apps.*

    The Telephant API's backbone is HTTP. The nature of our API is RESTful. It has a set of predictable resource URLs. It returns HTTP response codes to indicate errors. It also accepts JSON as an HTTP body payload and returns it, along with some other useful formats.
    
    You can use your favorite HTTP/REST library for your programming language or an HTTP client like Postman or CURL to use Telephant's API.

    Happy programming **:-)**

    ## HTTP Response Status Codes
    HTTP response status codes show whether or not a particular HTTP request was completed successfully. Section 10 of RFC 2616 defines the status codes listed below. RFC 7231 contains an updated specification.

    Telephant API makes use of the following HTTP status codes, grouped into three classes:

    ### Successful Responses - 2XX

    #### 200 - OK

    The request has succeeded.

    #### 201 - Created

    As a result of the request's success, a new resource has been generated. This is the response that is normally sent in response to POST or some PUT queries.

    ### Client Error - 4XX
    
    #### 400 - Bad Request
    Due to incorrect syntax, the server was unable to understand the request.
    
    #### 401 - Unauthorized
    Authentication is required and has failed or has not yet been provided.
    
    #### 403 - Forbidden
    The server refuses to provide the requested resource because the client does not have access permissions to the resource; that is, it is unauthorized. Unlike 401, the server is aware of the client's identity.
    
    #### 404 - Not Found
    The requested resource was not found. The client is free to make additional requests.
    
    #### 405 - Method Not Allowed
    A GET request on a form that needs data to be presented via POST, or a PUT request on a read-only resource, for example, is not supported for the requested resource.

    ### Server Error - 5XX

    #### 500 - Internal Server Error
    The server has come upon a circumstance that it is unsure how to handle.  Our team will be reviewing the root cause of issues and resolving the problems as soon as possible.

    ## Headers

    ### Accept
    Clients can send requests with varied values for the 'Accept' header, and the response format will be adjusted to accommodate the request. This is supplied to make interacting with browsers and other clients easier. It's worth noting that only JSON-formatted success and error messages will be returned. The API is designed to return JSON in general, hence the functionality is not further documented.

    #### Mime Types Accepted:
    - text/plain - will return a string of text
    - text/html - will return a formatted table of results
    - application/json - will return formatted json
    - text/csv - will return results in a downloadable CSV file

    ### account_id Header
    Clients can send requests as a separate account associated to the username by including the account_id header, which should contain the Telephant account ID of the account the client desires to act on.

  terms-of-service: http://www.telephant.co.za/terms-of-service
  version: '1.0'
  contact:
    name: Telephant API Team
    url: http://developer.telephant.co.za
    email: api@telephant.co.za
  x-logo:
    url: "http://developer.telephant.co.za/telephant-documentation-logo.jpg"
    backgroundColor: "#fafafa"

servers:
  - description: Sandbox Server
    url: https://localhost:3443
  - description: Live Server
    url: https://api.telephant.co.za

tags:
- name: Accounts
  description: In addition to a user's own account, organizations such as enterprises, clubs, and homes can create accounts. Multiple users can manage an account, which has its own resources and actions.
- name: Airtime
  description: |
    Airtime is the life blood of the Telephant service.  This endpoint allows you to check an account's airtime balance, send and request airtime from your contacts.
    
    **Note:**  You'll need a verified contact in order to request or them send airtime.
- name: Contacts
  description: |
    You may view and edit an account's contacts listings, as well as add, update, and delete details contacts, using this end point.
    
    **Note:**  You'll need a verified contact in order to request or them send airtime.
- name: Notifications
  description: Review read, unread or all the notifications sent about your account. Also mark notifications as read.
- name: Retailers
  description: Obtain a public list of Telephant credit-accepting merchants. Add, delete, or edit merchant information that will be made public.
- name: Transactions
  description: View the details of a given transaction from a filtered or unfiltered list of transactions on an account.
- name: Users
  description: |
    Logging in and registering are both done through the Users endpoint.

    **Note:** Before you can use this API, you must first sign up and then use the login action to receive a JWT bearer token.

    Signup and login are the two actions available at this endpoint. You use the same endpoint and request body for both signup and login, but you'll need to change the action query parameter to specify the action you're trying to accomplish.

    Obviously, you must be signed up before attempting to log in. You only need to sign up once, however you may need to login numerous times because the API requires a JWT bearer token to connect with its endpoints.

- name: Ping
  description: |
    Ping is a utility function that can be used to test the health of the Telephant service.  The ping service only responds with 'Pong'.

x-tagGroups:
  - name: Functionality
    tags:
      - Accounts
      - Airtime
      - Contacts
      - Notifications
      - Retailers
      - Transactions
      - Users
  - name: Utility
    tags:
      - Ping

paths:
  /v1/accounts:
    get:
      summary: Get account(s).
      description: Get the details of a specific account(s). List one or all of the details of accounts available to this username.
      tags:
        - Accounts
      security:
        - BearerAuth: []
      parameters:
      - in: header
        name: account_id
        description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
        schema:
          type: string
          format: uuid
        required: false
      - in: query
        name: page
        description: The page number of results to return.
        schema:
            type: integer
      - in: query
        name: limit
        description: The numbers of items to return per page.
        schema:
          type: integer
      responses:
        '2XX':
          description: Success
          content:
            application/json:
              examples:
                Accounts-Get:
                  $ref: '#/components/examples/Accounts-Get'

        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
    post:
      summary: Create account.
      description: Create a new group account.
      tags:
        - Accounts
      security:
        - BearerAuth: []
      requestBody:
        description: Define the properties of the account to create.
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - accountName
              properties:
                accountName:
                  type: string
                  minLength: 3
                  maxLength: 16
                  example: my-company
                  description: |
                                  This field must be used as a reference on bank statements, 
                                  and Telephant will use it to simplify the process.
                                  
                                  **Note:** Only alphanumeric characters and hyphens as spaces are accepted 
                                  in this field.

                                  **Note:** The account id in the header will be ignored because 
                                  the owner of the group account will be set to your username's phone number.

                  format: /^[a-z0-9-]{3,16}$/
                description:
                  type: string
                  maxLength: 300
                  example: My Company (Pty) Ltd Airtime Account

      responses:
        '200':
          description: Success
          content: 
            application/json:
              example:
                {
                    message: 'The group account was successfully created.'
                }
        '400':
          description: BadRequestError
          content: 
            application/json:
              example:
                {
                    "code": 400,
                    "name": "BadRequestError",
                    "message": "Account validation failed : A account name is required."
                }

        '409':
          description: Conflict
          content: 
            application/json:
              example:
                {
                    "code": 409,
                    "name": "ConflictError",
                    "message": "This group account name is already registered.  Please choose another."
                }

        '5XX':
          $ref: '#/components/responses/5XX'
    put:
      summary: Update account.
      description: |
                      Update the details of a group account.

                      **Note:** It is not possible to update your own username's account through the API 
                      so an account_id must be provided in the header.
      tags:
        - Accounts
      security:
        - BearerAuth: []
      requestBody:
        description: |
                        Define the properties of the account to update.

                        The fields that are available to be modified are:
                        - owners
                        - description
                        - businessType
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                owners:
                  type: string
                  pattern: ^(27)[0-9]{9}$
                  example: 27821234567
                  description: | 
                    In the South African phone number format, a user's unique mobile phone number.

                    You can assign multiple owners to a group account but only one per request.
                description:
                  type: string
                  maxLength: 300
                  example: My Company (Pty) Ltd Airtime Account
                businessType:
                  type: string
                  enum:
                    - private
                    - public
                    - ngo
                    - gov
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: true
      responses:
        '201':
          description: Success
          content: 
            application/json:
              example:
                {
                    message: 'The group account was successfully updated.'
                }          

        '4XX':
          description: BadRequestError
          content:
            application/json:
              examples:
                ConflictError-1:
                  value:
                    {
                        "code": 400,
                        "name": "ConflictError",
                        "message": "The user telephone number is already an owner on this account."
                    }
                ConflictError-2:
                  value:
                    {
                        "code": 400,
                        "name": "ConflictError",
                        "message": "Not a valid user's telphone number."
                    }
                ConflictError-3:
                  value:
                    {
                        "code": 400,
                        "name": "ConflictError",
                        "message": "No relevant fields to update were defined."
                    }

        '5XX':
          $ref: '#/components/responses/5XX'
    delete:
      deprecated: true
      summary: Delete account.
      description: |
                      Delete a specific group account.

                      **Note:** The ability to delete a group account has been removed.  
                      In future a method for achieving the deletion of an account will be implemented
                      on the UPDATE method.
      tags:
        - Accounts
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: true
      responses:
        '410':
          description: Gone
          content: 
            application/json:
              example:
                {
                    "code": 410,
                    "name": "Gone",
                    "message": "The ability to delete a group account has been removed.  In future a method for achieving this will be implemented."
                }
  /v1/airtime:
    get:
      summary: Get airtime balance.
      description: Check the balance of a group or individual accounts airtime balance.
      tags:
        - Airtime
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
    post:
      summary: Use airtime.
      description: Convert positive airtime balance for use as airtime on phone.
      tags:
        - Airtime
      security:
        - BearerAuth: []
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
  /v1/airtime/{ContactsPhoneNumber}:
    get:
      summary: Request airtime.
      description: Request airtime credit from a contact.
      tags:
        - Airtime
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: ContactsPhoneNumber
          schema:
            type: string
            pattern: ^(27)[0-9]{9}$
          required: true
          description: A contact's unique mobile phone number from an accounts contacts list.
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
    post:
      summary: Send airtime.
      description: Send airtime credit to a contact.
      tags:
        - Airtime
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: ContactsPhoneNumber
          schema:
            type: string
            pattern: ^(27)[0-9]{9}$
          required: true
          description: A contact's unique mobile phone number from an accounts contacts list.
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

#### CONTACTS ####
  /v1/contacts:

### GET CONTACTS /v1/contacts ###
    get:
      summary: List the contacts.
      description: List the contacts of an individual or group account. 
      tags:
        - Contacts
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
        - in: query
          name: page
          description: The page number of results to return.
          schema:
              type: integer
        - in: query
          name: limit
          description: The numbers of items to return per page.
          schema:
            type: integer
      responses:
        '2XX':
          description: Success
          content:
            application/json:
              examples:
                Accounts-Get:
                  $ref: '#/components/examples/Contacts-Get'
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

### POST CONTACT /v1/contacts ###
    post:
      summary: Create contact.
      description: |
        Create a contact for a individual or group account.

        **Note** The account or username that makes the request will be assigned as the owner account.  It is not possible to change a contact's ownership to multiple owners.
      tags:
        - Contacts
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      requestBody:
        description: |
          Define the properties of the contact to create.

          You can set a property to null.
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - telephoneNumber
              properties:
                telephoneNumber:
                  type: string
                  pattern: ^(27)[0-9]{9}$
                  description: Provide a valid South African mobile telphone number in the format 27XXXXXXXXX.
                  example: "27821234567"
                  required: true
                firstName:
                  description: You can only use alpha characters in a name.
                  type: string
                  maxLength: 30
                  example: Piet
                  pattern: /^[a-zA-Z]*$/
                lastName:
                  description: You can only use alpha characters in a name.
                  type: string
                  maxLength: 30
                  example: Pompies
                  pattern: /^[a-zA-Z]*$/
                email:
                  description: A valid email address for the contact.
                  type: string
                  format: email
                  example: piet@example.com
      responses: 
        '200':
          description: Success
          content:
            application/json:
              example:
                { 
                  message: 'The contact was successfully created.' 
                }   
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

### GET CONTACT /v1/contacts/{contact_id} ###
  /v1/contacts/{contact_id}:
    get:
      summary: View specific contact.
      description: Get the details of a specific contact from an individual or group account.
      tags:
        - Contacts
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: contact_id
          schema:
            type: string
            format: uuid
          required: true
          description: |
            A contact's unique ID from the contacts list.

            Because it is possible to have two contacts with the same phone number in your contacts list, the contacts _id must be used to get, update or delete the contact from the list.
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '200':
          description: Success
          content: 
            application/json:
              examples:
                Contact-Get:
                  $ref: '#/components/examples/Contact-Get'
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

### PUT CONTACT /v1/contacts/{Contact_ID} ###
    put:
      summary: Update a specific contact.
      description: Update a specific contact for an individual or group account.
      tags:
        - Contacts
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: contact_id
          schema:
            type: string
            format: uuid
          required: true
          description: |
            A contact's unique ID from the contacts list.

            Because it is possible to have two contacts with the same phone number in your contacts list, the contacts id must be used to get, update or delete the contact from the list.

        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      requestBody:
        description: |
          Define the properties of the contact to create.

          You can set a property to null.
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - telephoneNumber
              properties:
                telephoneNumber:
                  type: string
                  pattern: ^(27)[0-9]{9}$
                  description: Provide a valid South African mobile telphone number in the format 27XXXXXXXXX.
                  example: "27821234567"
                  required: true
                firstName:
                  description: You can only use alpha characters in a name.
                  type: string
                  maxLength: 30
                  example: Piet
                  pattern: /^[a-zA-Z]*$/
                lastName:
                  description: You can only use alpha characters in a name.
                  type: string
                  maxLength: 30
                  example: Pompies
                  pattern: /^[a-zA-Z]*$/
                email:
                  description: A valid email address for the contact.
                  type: string
                  format: email
                  example: piet@example.com
      responses:
        '200':
          description: Success
          content: 
            application/json:
              example:
                {
                    message: 'The contact was successfully updated.'
                }
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

### DELETE CONTACT /v1/contacts/{contact_id} ###
    delete:
      summary: Delete specific contact.
      description: Delete a specific contact for an individual or group account.
      tags:
        - Contacts
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: contact_id
          schema:
            type: string
            format: uuid
          required: true
          description: |
            A contact's unique ID from the contacts list.

            Because it is possible to have two contacts with the same phone number in your contacts list, the contacts _id must be used to get, update or delete the contact from the list.

        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '200':
          description: Success
          content: 
            application/json:
              example:
                {
                    message: 'Contact succesfully deleted.'
                }
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

#############################################
  /v1/notifications:
    get:
      summary: List of notifications.
      description: Get the list of notifications for an individual or group account.
      tags:
        - Notifications
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
        - in: query
          name: page
          description: The page number of results to return.
          schema:
            type: integer
        - in: query
          name: limit
          description: The numbers of items to return per page.
          schema:
            type: integer
      responses:
        '2XX':
          description: Success
          content:
            application/json:
              examples:
                Notifcations-Get:
                  $ref: '#/components/examples/Notifications-Get'

        '4XX':
          $ref: '#/components/responses/4XX'
        '5XX':
          $ref: '#/components/responses/5XX'

    post:
      summary: Mark all notifications read.
      description: Changes the status of all notifications to read.
      tags:
        - Notifications
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '2XX':
          description: Success
          content:
            application/json:
              example:
                {
                    message: '10 notifications were marked as read.'
                }
        '4XX':
          $ref: '#/components/responses/4XX'
        '5XX':
          $ref: '#/components/responses/5XX'

  /v1/notifications/count:
    get:
      summary: Get a count of notifications.
      description: Get a count of read, unread and total notifications.
      tags:
        - Notifications
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '2XX':
          description: Success
          content:
            application/json:
              examples:
                Notifications-Get:
                  $ref: '#/components/examples/Notifications-Count'
        '4XX':
          $ref: '#/components/responses/4XX'
        '5XX':
          $ref: '#/components/responses/5XX'

  /v1/notifications/{NotificationID}:
    get:
      summary: Get specific notification.
      description: Retrieve the details of a specific notification by it's id.
      tags:
        - Notifications
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
        - in: path
          name: NotificationID
          description: Use a valid resource id to identify the notification to query.
          schema:
            type: string
            format: uuid
          required: true
          example: '60ebd53e2f79311541619554'
      responses:
        '2XX':
          description: Success
          content:
            application/json:
              examples:
                Notifications-Get-Item:
                  $ref: '#/components/examples/Notifications-Get-Item'
        '4XX':
          $ref: '#/components/responses/4XX'
        '5XX':
          $ref: '#/components/responses/5XX'

    post:
      summary:  Mark notification as read.
      description: Mark a specific notification as read for an individual or group account.
      tags:
        - Notifications
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
        - in: path
          name: NotificationID
          description: Use a valid resource id to identify the notification to query.
          schema:
            type: string
            format: uuid
          required: true
          example: '60ebd53e2f79311541619554'
      responses:
        '2XX':
          description: Success
          content:
            application/json:
              example:
                {
                    message: 'The notification was marked as read.'
                }
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

  /ping:
    get:
      summary: Ping the API.
      description: To make sure the API is up and working, ping the server.
      tags:
        - Ping
      responses:
        '200':
          description: This API call only returns 'pong' to confirm that the API is up and running.
          content:
            application/json:
              schema:
                properties:
                  message:
                    type: string
                    example: Pong.

  /v1/retailers:
    get:
      summary: List retailers.
      description: Get a listing of Telephant retailers.
      tags:
        - Retailers
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
    post:
      summary: Create a retailer listing.
      description: Create a Telephant retailer listing.
      tags:
        - Retailers
      security:
        - BearerAuth: []
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: true
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
  /v1/retailers/{RetailerID}:
    put:
      summary: Update retailer.
      description: Update a retailer listing.
      tags:
        - Retailers
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: RetailerID
          schema:
            type: string
            format: uuid
          required: true
          description: Unique ID of the retailer listing.
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: true
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
    delete:
      summary: Delete retailer.
      description: Delete a retailer listing.
      tags:
        - Retailers
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: RetailerID
          schema:
            type: string
            format: uuid
          required: true
          description: Unique ID of the retailer listing.
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: true
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
  /v1/transactions:
    get:
      summary: List transactions.
      description: Get a transaction listing for an individual or group account.
      parameters:
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      tags:
        - Transactions
      security:
        - BearerAuth: []
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'
  /v1/transactions/{TransactionID}:
    get:
      summary: View a transaction.
      description: View the details of a specific transaction for an individual or group account.
      tags:
        - Transactions
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: TransactionID
          schema:
            type: string
            format: uuid
          required: true
          description: Unique ID of the transaction.
        - in: header
          name: account_id
          description: Clients can make requests as connected accounts using the special header account_id which should contain a Telephant account ID.
          schema:
            type: string
            format: uuid
          required: false
      responses:
        '4XX':
          $ref: '#/components/responses/4XX'

        '5XX':
          $ref: '#/components/responses/5XX'

  /v1/users?status=signup:
    post:
      summary: User signup.
      description: An end point to sign up as a user.
      tags:
        - Users
      parameters:
        - in: query
          name: action
          schema:
            type: string
            enum:
              - signup
          description: |

            User actions can be:
             * `signup` - Create a user account.
             * `login` - As a user, sign in.
      requestBody:
        description: Provide the telephone number and a password to signup.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Users'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  
                  message: 
                    type: string
                    example: 'The user was successfully registered.'
        '400':
          description: Bad Request
          content:
            application/json:
              examples:
                Password-complexity:
                  value:
                    {
                      "code": 400,
                      "name": "BadRequestError",
                      "message": 'User validation failed : Password not complex enough.'
                    }
                South-Africa-format:
                  value:
                    {
                      "code": 400,
                      "name": "BadRequestError",
                      "message": 'User validation failed : The telephone number does not conform to the South African format (27XXXXXXXXX).'
                    }
                User-taken:
                  value:
                    {
                      "code": 400,
                      "name": "BadRequestError",
                      "message": "This telephone number is already registered."
                    }
        '5xx':
          $ref: '#/components/responses/5XX'

  /v1/users?status=login:
    post:
      summary: User login.
      description: An end point to log in a user.
      tags:
        - Users
      parameters:
        - in: query
          name: action
          schema:
            type: string
            enum:
              - login
          description: |

            User actions can be:
             * `signup` - Create a user account.
             * `login` - As a user, sign in.
      requestBody:
        description: Provide the telephone number and a password to login.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Users'
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: 'User successfully logged in.'
                  token:
                    type: string
                    example: 'BEARER <TOKEN STRING>'
        '401':
          description: Unauthorised
          content:
            application/json:
              example:
                  {
                    "code": 401,
                    "name": "UnauthorizedError",
                    "message": "Unable to authenticate using credentials provided."
                  }
        '5xx':
          $ref: '#/components/responses/5XX'


components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Users:
      type: object
      properties:
        telephoneNumber:
          type: string
          pattern: ^(27)[0-9]{9}$
          description: Provide a valid South African mobile telphone number in the format 27XXXXXXXXX.
          example: "27821234567"
        password:
          type: string
          pattern: /(?=^.{8,}$)(?=.*\d)(?=.*[!@#$%^&*]+)(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/
          description: |
            Provide a suitable password.
              * The password length must be greater than or equal to 8
              * The password must contain one or more uppercase characters
              * The password must contain one or more lowercase characters
              * The password must contain one or more numeric values
              * The password must contain one or more special characters
            example: P@ssword123

    Transactions:
      type: object
      required:
        - amount
        - sign
        - type
      properties:
        accountID:
          type: string
          format: uuid
        date-time:
          type: string
          format: date-time
        amount:
          type: number
        sign:
          type: boolean
        type:
          type: string
          enum:
            - SEND
            - RECEIVE
      description: The Transactions are represented in the form of the following JSON model.

    Notifications:
      type: object
      properties:
        _id:
          type: string
          format: uuid
        dateTime:
          example: "2021-05-11T16:55:00.000Z"
          type: string
          format: date-time
        read:
          example: false
          type: boolean
        type:
          example: "INFO"
          type: string
          enum:
            - INFO
            - REQUEST
        subject:
          example: "Top Up"
          type: string
        message:
          example: "You deposited R 1500 into your telphant account."
          type: string
        owner: 
          example: "my-business-1"
          type: string
        link: 
          example: "3zm9e5o5"
          type: string
        createdAt:
          example: "2021-07-26T15:34:09.689Z"
          type: string
          format: date-time
        updatedAt:
          example: "2021-07-26T15:34:09.689Z"
          type: string
          format: date-time
      description: The Notifications are represented in the form of the following JSON model.

  responses:
    4XX:
      description: |
        Client error
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: Integer
                example: 400
                description: |
                  Please review the documentation for [HTTP Response Status Codes](/#section/HTTP-Response-Status-Codes)

                  Possible values are:
                    - 400 - Bad Request
                    - 401 - Unauthorized
                    - 403 - Forbidden
                    - 404 - Not Found
                    - 405 - Method Not Allowed
              name:
                type: String
                example: 'BadRequest'
                description: This value will always be returned as 'bumpy case'.
              message:
                type: String
                description: |
                  The message field will provide specific information as to the reason for the error.
                example: 'The account ID provided is not valid.'

    5XX:
      description: |
        Server error  
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: Integer
                example: 500
              name:
                type: String
                example: 'InternalServerError'
              message:
                type: String
                example: 'We are sorry but something went wrong on our side.'

  examples:
    Notifications-Get-Item:
      value:
        {
            "dateTime": "2021-05-23T07:18:00.000Z",
            "read": false,
            "type": "INFO",
            "_id": "60fed5f105b740691acc2d91",
            "subject": "Sent",
            "message": "You sent Napoleon R 50",
            "owner": "my-business-1",
            "link": "y3huwi17",
            "createdAt": "2021-07-26T15:34:09.689Z",
            "updatedAt": "2021-07-26T15:34:09.689Z",
            "__v": 0
        }
    Notifications-Count:
      value:
        {
            "read": 10,
            "unread": 2,
            "total": 12
        }

    Notifications-Get:
      value:
        {
          "page": 1,
          "total_pages": 1,
          "total_results": 2,
          "results": [
                        {
                            "dateTime": "2021-05-11T16:55:00.000Z",
                            "read": false,
                            "type": "INFO",
                            "_id": "60fed5f105b740691acc2d8d",
                            "subject": "Top Up",
                            "message": "You deposited R 1500 into your telphant account.",
                            "owner": "my-business-1",
                            "link": "3zm9e5o5",
                            "createdAt": "2021-07-26T15:34:09.689Z",
                            "updatedAt": "2021-07-26T15:34:09.689Z",
                            "__v": 0
                        },
                        {
                            "dateTime": "2021-05-23T07:18:00.000Z",
                            "read": false,
                            "type": "INFO",
                            "_id": "60fed5f105b740691acc2d91",
                            "subject": "Sent",
                            "message": "You sent Napoleon R 50",
                            "owner": "my-business-1",
                            "link": "y3huwi17",
                            "createdAt": "2021-07-26T15:34:09.689Z",
                            "updatedAt": "2021-07-26T15:34:09.689Z",
                            "__v": 0
                        }
                      ]
        }
    Accounts-Get:
      value:
        {
          "page": 1,
          "total_pages": 1,
          "total_results": 3,
          "results": [
                        {
                          "_id": "60f57f3a6023f819ae7aa454",
                          "accountName": "27829524031"
                        },
                        {
                          "_id": "60ebd53e2f79311541618bc4",
                          "accountName": "MyCompany",
                          "description": "The account description for My Company"
                        },
                        {
                          "_id": "60ebd53e2f79311541618bc5",
                          "accountName": "My Company 2",
                          "description": "The account description for My Company 2"
                        }
                    ]
                }
    Contact-Get:
      value:
        [
            {
                "_id": "610557d603e71002e0219158",
                "telephoneNumber": "27434921801",
                "firstName": null,
                "lastName": "Gatlin",
                "owner": "27829524031",
                "__v": 0
            }
        ]
    Contacts-Get:
      value:
        {
    "page": 1,
    "total_pages": 5,
    "total_results": 41,
    "results": [
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea09",
            "telephoneNumber": "27828400904",
            "firstName": "Avrom",
            "lastName": "Ateggart",
            "email": "aateggart4@linkedin.com"
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea0e",
            "telephoneNumber": "27962371963",
            "firstName": "Berkie",
            "lastName": null
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea13",
            "telephoneNumber": "27415630343",
            "firstName": "Hyman",
            "lastName": "Maudlin",
            "email": "hmaudline@huffingtonpost.com"
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea18",
            "telephoneNumber": "27422531972",
            "firstName": "Ignatius",
            "lastName": "Bransdon"
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea1d",
            "telephoneNumber": "27534405808",
            "firstName": "Donica",
            "lastName": "Ussher"
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea22",
            "telephoneNumber": "27706368969",
            "firstName": "Dreddy",
            "lastName": null
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea27",
            "telephoneNumber": "27691370795",
            "firstName": "Jeremie",
            "lastName": "Desport"
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea05",
            "telephoneNumber": "27847470159",
            "firstName": "Bartlet",
            "lastName": null,
            "email": "bfairbourne0@nymag.com"
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea0a",
            "telephoneNumber": "27230295211",
            "firstName": "Bronnie",
            "lastName": "Meader"
        },
        {
            "owner": [
                "27829524031"
            ],
            "_id": "61027161e2eb5f1e6831ea0f",
            "telephoneNumber": "27129256706",
            "firstName": null,
            "lastName": "Giamitti",
            "email": "agiamittia@bluehost.com"
        }
    ]
}

